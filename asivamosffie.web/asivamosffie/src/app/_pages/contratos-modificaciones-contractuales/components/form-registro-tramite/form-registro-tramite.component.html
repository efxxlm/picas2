<form *ngIf="modalidadContratoArray.length > 0" autocomplete="off" [formGroup]="dataFormulario" (ngSubmit)="guardar()">
  <div class="row">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="numeroContrato"
            [class.color-secondaryColor]="
              (dataFormulario.get('numeroContrato').invalid && dataFormulario.get('numeroContrato').touched) ||
              (dataFormulario.get('numeroContrato').invalid && estaEditando)
            "
          >
            Número del contrato
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input matInput type="text" maxlength="10" formControlName="numeroContrato" required />
          </mat-form-field>
          <span
            class="contador"
            [matTooltipPosition]="'above'"
            matTooltip="Campo alfanumérico"
            matTooltipClass="info-tooltip"
          >
            {{ 10 - dataFormulario.get('numeroContrato').value.length }}
          </span>
          <span class="icon-incompleto">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('numeroContrato').invalid && dataFormulario.get('numeroContrato').touched) ||
                (dataFormulario.get('numeroContrato').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="modalidadContrato"
            [class.color-secondaryColor]="
              (dataFormulario.get('modalidadContrato').invalid && dataFormulario.get('modalidadContrato').touched) ||
              (dataFormulario.get('modalidadContrato').invalid && estaEditando)
            "
          >
            Modalidad del contrato
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field class="select-width">
            <mat-select formControlName="modalidadContrato" required>
              <mat-option *ngFor="let modalidad of modalidadContratoArray" [value]="modalidad.codigo">
                {{ modalidad.nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <span
            [matTooltipPosition]="'above'"
            matTooltip="Campo de selección unica"
            matTooltipClass="info-tooltip"
          ></span>

          <span class="icon-incompleto" style="margin-left: 3.2em">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('numeroContrato').invalid && dataFormulario.get('numeroContrato').touched) ||
                (dataFormulario.get('numeroContrato').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div
    class="row"
    *ngIf="
      dataFormulario.get('modalidadContrato').value !== null && dataFormulario.get('numeroContrato').value.length > 0
    "
  >
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="fechaEnvioParaFirmaContratista"
            [class.color-secondaryColor]="
              (dataFormulario.get('fechaEnvioParaFirmaContratista').invalid &&
                dataFormulario.get('fechaEnvioParaFirmaContratista').touched) ||
              (dataFormulario.get('fechaEnvioParaFirmaContratista').invalid && estaEditando)
            "
          >
            Fecha de envío para firma del contratista
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input
              matInput
              [matDatepicker]="pickerFechaEnvioTramite"
              [min]="fechaTramite"
              formControlName="fechaEnvioParaFirmaContratista"
              placeholder="DD/MM/AAAA"
              [class.invalid]="campoSinDiligenciar('fechaEnvioParaFirmaContratista')"
              (click)="pickerFechaEnvioTramite.open()"
              readonly
              required
            />
            <mat-datepicker #pickerFechaEnvioTramite></mat-datepicker>
          </mat-form-field>
          <button
            mat-button
            color="primary"
            type="button"
            (click)="pickerFechaEnvioTramite.open()"
            class="btn-calendario"
          >
            <img class="mr-bottom-1" src="assets/img/icon/calendarioCirculo.svg" alt="Abrir Calendario" />
          </button>
          <span class="icon-incompleto">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('fechaEnvioParaFirmaContratista').invalid &&
                  dataFormulario.get('fechaEnvioParaFirmaContratista').touched) ||
                (dataFormulario.get('fechaEnvioParaFirmaContratista').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get('fechaEnvioParaFirmaContratista').value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="fechaFirmaPorParteContratista"
            [class.color-secondaryColor]="
              (dataFormulario.get('fechaFirmaPorParteContratista').invalid &&
                dataFormulario.get('fechaFirmaPorParteContratista').touched) ||
              (dataFormulario.get('fechaFirmaPorParteContratista').invalid && estaEditando)
            "
          >
            Fecha de firma por parte del contratista
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input
              matInput
              [matDatepicker]="pickerFechaFirmaContratista"
              [min]="fechaTramite"
              formControlName="fechaFirmaPorParteContratista"
              placeholder="DD/MM/AAAA"
              [class.invalid]="campoSinDiligenciar('fechaFirmaPorParteContratista')"
              (click)="pickerFechaFirmaContratista.open()"
              readonly
              required
            />
            <mat-datepicker #pickerFechaFirmaContratista></mat-datepicker>
          </mat-form-field>
          <button
            mat-button
            color="primary"
            type="button"
            (click)="pickerFechaFirmaContratista.open()"
            class="btn-calendario"
          >
            <img class="mr-bottom-1" src="assets/img/icon/calendarioCirculo.svg" alt="Abrir Calendario" />
          </button>
          <span class="icon-incompleto">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('fechaFirmaPorParteContratista').invalid &&
                  dataFormulario.get('fechaFirmaPorParteContratista').touched) ||
                (dataFormulario.get('fechaFirmaPorParteContratista').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get('fechaFirmaPorParteContratista').value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="fechaEnvioParaFirmaFiduciaria"
            [class.color-secondaryColor]="
              (dataFormulario.get('fechaEnvioParaFirmaFiduciaria').invalid &&
                dataFormulario.get('fechaEnvioParaFirmaFiduciaria').touched) ||
              (dataFormulario.get('fechaEnvioParaFirmaFiduciaria').invalid && estaEditando)
            "
          >
            Fecha de envío para la firma de la fiduciaria
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input
              matInput
              [matDatepicker]="pickerFechaEnvioFirmaFiduciaria"
              [min]="fechaTramite"
              formControlName="fechaEnvioParaFirmaFiduciaria"
              placeholder="DD/MM/AAAA"
              [class.invalid]="campoSinDiligenciar('fechaEnvioParaFirmaFiduciaria')"
              (click)="pickerFechaEnvioFirmaFiduciaria.open()"
              readonly
              required
            />
            <mat-datepicker #pickerFechaEnvioFirmaFiduciaria></mat-datepicker>
          </mat-form-field>
          <button
            mat-button
            color="primary"
            type="button"
            (click)="pickerFechaEnvioFirmaFiduciaria.open()"
            class="btn-calendario"
          >
            <img class="mr-bottom-1" src="assets/img/icon/calendarioCirculo.svg" alt="Abrir Calendario" />
          </button>
          <span class="icon-incompleto">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('fechaEnvioParaFirmaFiduciaria').invalid &&
                  dataFormulario.get('fechaEnvioParaFirmaFiduciaria').touched) ||
                (dataFormulario.get('fechaEnvioParaFirmaFiduciaria').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get('fechaEnvioParaFirmaFiduciaria').value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            for="fechaFirmaPorParteFiduciaria"
            [class.color-secondaryColor]="
              (dataFormulario.get('fechaFirmaPorParteFiduciaria').invalid &&
                dataFormulario.get('fechaFirmaPorParteFiduciaria').touched) ||
              (dataFormulario.get('fechaFirmaPorParteFiduciaria').invalid && estaEditando)
            "
          >
            Fecha de firma por parte de la fiduciaria
          </label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input
              matInput
              [matDatepicker]="pickerFechaFirmaFiduciaria"
              [min]="fechaTramite"
              formControlName="fechaFirmaPorParteFiduciaria"
              placeholder="DD/MM/AAAA"
              [class.invalid]="campoSinDiligenciar('fechaFirmaPorParteFiduciaria')"
              (click)="pickerFechaFirmaFiduciaria.open()"
              readonly
              required
            />
            <mat-datepicker #pickerFechaFirmaFiduciaria></mat-datepicker>
          </mat-form-field>
          <button
            mat-button
            color="primary"
            type="button"
            (click)="pickerFechaFirmaFiduciaria.open()"
            class="btn-calendario"
          >
            <img class="mr-bottom-1" src="assets/img/icon/calendarioCirculo.svg" alt="Abrir Calendario" />
          </button>
          <span class="icon-incompleto">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('fechaFirmaPorParteFiduciaria').invalid &&
                  dataFormulario.get('fechaFirmaPorParteFiduciaria').touched) ||
                (dataFormulario.get('fechaFirmaPorParteFiduciaria').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            [class.color-secondaryColor]="
              (dataFormulario.get('observaciones').invalid && dataFormulario.get('observaciones').touched) ||
              (dataFormulario.get('observaciones').invalid && estaEditando)
            "
          >
            Observaciones
          </label>
        </div>
        <div class="col d-flex">
          <quill-editor
            class="quill-editor-style ml-1em card position-relative"
            [styles]="editorStyle"
            [modules]="config"
            (onContentChanged)="maxLength($event, 2000)"
            formControlName="observaciones"
            [class.invalid]="
              (dataFormulario.get('observaciones').invalid && dataFormulario.get('observaciones').touched) ||
              (dataFormulario.get('observaciones').invalid && estaEditando)
            "
            required
          >
          </quill-editor>
          <span
            class="contador miles"
            *ngIf="dataFormulario.get('observaciones').value !== null"
            style="margin-top: 1.8em"
          >
            {{
              2000 -
                (textoLimpio(dataFormulario.get('observaciones').value) > 2000
                  ? 2000
                  : textoLimpio(dataFormulario.get('observaciones').value))
            }}
          </span>
          <span
            class="contador miles"
            *ngIf="dataFormulario.get('observaciones').value === null"
            style="margin-top: 1.8em"
          >
            2000
          </span>
          <span class="icon-incompleto" style="margin-top: 1.9em">
            <img
              class="icon-incompleto--img"
              src="assets/img/icon/incompleto.svg"
              alt="este campo es requerido"
              [matTooltipPosition]="'above'"
              matTooltip="Debe ingresar la información en el campo para continuar"
              matTooltipClass="info-tooltip"
              *ngIf="
                (dataFormulario.get('observaciones').invalid && dataFormulario.get('observaciones').touched) ||
                (dataFormulario.get('observaciones').invalid && estaEditando)
              "
            />
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get('fechaFirmaPorParteFiduciaria').value !== null" style="margin-top: 2em">
    <div class="col-md-12">
      <div class="row">
        <div class="pr-1">
          <label
            class="label-left"
            style="margin-top: 1.4em"
            [class.color-secondaryColor]="
              (dataFormulario.get('documentoFile').invalid && dataFormulario.get('documentoFile').touched) ||
              (dataFormulario.get('documentoFile').invalid && estaEditando)
            "
          >
            Adjuntar documento suscrito
          </label>
        </div>
        <div class="col d-flex">
          <span
            class="input-file-text text-center required"
            (click)="fileInput.click()"
            style="width: 100%"
            [class.invalid]="
              (dataFormulario.get('documentoFile').invalid && dataFormulario.get('documentoFile').touched) ||
              (dataFormulario.get('documentoFile').invalid && estaEditando)
            "
          >
            {{ archivo || dataFormulario.get('documento').value }}
          </span>
          <button mat-raised-button color="primary" type="button" (click)="fileInput.click()" class="input-file--btn">
            Adjuntar
          </button>
          <input
            required
            hidden
            (change)="fileName($event)"
            #fileInput
            type="file"
            id="file"
            formControlName="documentoFile"
            [placeholder]="archivo || dataFormulario.get('documento').value"
            [class.invalid]="campoSinDiligenciar('documentoFile')"
            accept="application/pdf"
          />
        </div>
        <span class="icon-incompleto">
          <img
            class="icon-incompleto--img"
            src="assets/img/icon/incompleto.svg"
            alt="este campo es requerido"
            [matTooltipPosition]="'above'"
            matTooltip="Debe ingresar la información en el campo para continuar"
            matTooltipClass="info-tooltip"
            *ngIf="
              (dataFormulario.get('documentoFile').invalid && dataFormulario.get('documentoFile').touched) ||
              (dataFormulario.get('documentoFile').invalid && estaEditando)
            "
          />
        </span>
      </div>
    </div>
  </div>

  <div class="container text-center" *ngIf="dataFormulario.get('fechaFirmaPorParteFiduciaria').value !== null">
    <p class="align-text">
      <small><i>Adjunte el contrato suscrito cuando tenga todas las firmas requeridas.</i></small>
    </p>
  </div>

  <div class="text-center" style="margin-top: 2em">
    <button mat-button color="warn" class="btn-guardar" type="submit">
      <img src="assets/img/icon/guardar.svg" alt="Regresar" />
    </button>
  </div>
</form>
