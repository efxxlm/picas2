<form autocomplete="off" [formGroup]="dataFormulario" (ngSubmit)="guardar()">
  <div class="row">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label class="label-left mt-1em">Número del contrato</label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
            <input  matInput
                    type="text"
                    maxlength="10"
                    formControlName="numeroContrato"
                    [class.invalid]="campoSinDiligenciar( 'numeroContrato' )"
                    required>
          </mat-form-field>
          <span class="contador">{{10 - dataFormulario.get( 'numeroContrato' ).value.length}}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get( 'numeroContrato' ).value.length > 0">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label class="label-left mt-1em">Fecha de envío para firma del contratista</label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
                          <input  matInput
                                  [matDatepicker]="pickerFechaEnvioTramite"
                                  [min]="fechaTramite"
                                  formControlName="fechaEnvioParaFirmaContratista"
                                  placeholder="DD/MM/AAAA"
                                  [class.invalid]="campoSinDiligenciar( 'fechaEnvioParaFirmaContratista' )"
                                  (click)="pickerFechaEnvioTramite.open()"
                                  readonly required>
            <mat-datepicker #pickerFechaEnvioTramite></mat-datepicker>
          </mat-form-field>
          <button mat-button
                  color="primary"
                  type="button"
                  (click)="pickerFechaEnvioTramite.open()"
                  class="btn-calendario">
                  <img  class="mr-bottom-1"
                        src="assets/img/icon/calendarioCirculo.svg"
                        alt="Abrir Calendario">
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get( 'fechaEnvioParaFirmaContratista' ).value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label class="label-left mt-1em">Fecha de firma por parte del contratista</label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
                          <input  matInput
                                  [matDatepicker]="pickerFechaFirmaContratista"
                                  [min]="fechaTramite"
                                  formControlName="fechaFirmaPorParteContratista"
                                  placeholder="DD/MM/AAAA"
                                  [class.invalid]="campoSinDiligenciar( 'fechaFirmaPorParteContratista' )"
                                  (click)="pickerFechaFirmaContratista.open()"
                                  readonly required>
            <mat-datepicker #pickerFechaFirmaContratista></mat-datepicker>
          </mat-form-field>
          <button mat-button
                  color="primary"
                  type="button"
                  (click)="pickerFechaFirmaContratista.open()"
                  class="btn-calendario">
                  <img  class="mr-bottom-1"
                        src="assets/img/icon/calendarioCirculo.svg"
                        alt="Abrir Calendario">
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get( 'fechaFirmaPorParteContratista' ).value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label class="label-left mt-1em">Fecha de envío para la firma de la fiduciaria</label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
                          <input  matInput
                                  [matDatepicker]="pickerFechaEnvioFirmaFiduciaria"
                                  [min]="fechaTramite"
                                  formControlName="fechaEnvioParaFirmaFiduciaria"
                                  placeholder="DD/MM/AAAA"
                                  [class.invalid]="campoSinDiligenciar( 'fechaEnvioParaFirmaFiduciaria' )"
                                  (click)="pickerFechaEnvioFirmaFiduciaria.open()"
                                  readonly required>
            <mat-datepicker #pickerFechaEnvioFirmaFiduciaria></mat-datepicker>
          </mat-form-field>
          <button mat-button
                  color="primary"
                  type="button"
                  (click)="pickerFechaEnvioFirmaFiduciaria.open()"
                  class="btn-calendario">
                  <img  class="mr-bottom-1"
                        src="assets/img/icon/calendarioCirculo.svg"
                        alt="Abrir Calendario">
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get( 'fechaEnvioParaFirmaFiduciaria' ).value !== null">
    <div class="col-md-8">
      <div class="row">
        <div class="pr-1">
          <label class="label-left mt-1em">Fecha de firma por parte de la fiduciaria</label>
        </div>
        <div class="col d-flex">
          <mat-form-field>
                          <input  matInput
                                  [matDatepicker]="pickerFechaFirmaFiduciaria"
                                  [min]="fechaTramite"
                                  formControlName="fechaFirmaPorParteFiduciaria"
                                  placeholder="DD/MM/AAAA"
                                  [class.invalid]="campoSinDiligenciar( 'fechaFirmaPorParteFiduciaria' )"
                                  (click)="pickerFechaFirmaFiduciaria.open()"
                                  readonly required>
            <mat-datepicker #pickerFechaFirmaFiduciaria></mat-datepicker>
          </mat-form-field>
          <button mat-button
                  color="primary"
                  type="button"
                  (click)="pickerFechaFirmaFiduciaria.open()"
                  class="btn-calendario">
                  <img  class="mr-bottom-1"
                        src="assets/img/icon/calendarioCirculo.svg"
                        alt="Abrir Calendario">
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="row">
        <div class="pr-1">
          <label class="label-left">Observaciones</label>
        </div>
        <div class="col d-flex">
          <quill-editor class="quill-editor-style ml-1em card"
                        [styles]="editorStyle"
                        [modules]="config"
                        (onContentChanged)="maxLength($event, 2000)"
                        formControlName="observaciones">
          </quill-editor>
          <span class="contador miles" *ngIf="dataFormulario.get('observaciones').value !== null" style="margin-top: 1.8em;">
            {{2000 - (textoLimpio(dataFormulario.get('observaciones').value)>2000?2000:textoLimpio(dataFormulario.get('observaciones').value))}}
          </span>
          <span class="contador miles" *ngIf="dataFormulario.get('observaciones').value === null" style="margin-top: 1.8em;">
            2000
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="dataFormulario.get( 'fechaFirmaPorParteFiduciaria' ).value !== null" style="margin-top: 2em;">
    <div class="col-md-12">
      <div class="row">
        <div class="pr-1">
          <label  class="label-left"
                  style="margin-top: 1.4em;">
                  Adjuntar documento suscrito
          </label>
        </div>
        <div class="col d-flex">
          <span class="input-file-text text-center required"
                (click)="fileInput.click()"
                style="width: 100%;">
            {{archivo || dataFormulario.get( 'documento' ).value}}
          </span>
          <button mat-raised-button color="primary" type="button" (click)="fileInput.click()" class="input-file--btn">
            Adjuntar
          </button>
          <input  required
                  hidden
                  (change)="fileName( $event )"
                  #fileInput
                  type="file"
                  id="file"
                  formControlName="documentoFile"
                  [placeholder]="archivo || dataFormulario.get( 'documento' ).value"
                  [class.invalid]="campoSinDiligenciar( 'documentoFile' )"
                  accept="application/pdf">
        </div>
      </div>
    </div>
  </div>

  <div class="container text-center" *ngIf="dataFormulario.get( 'fechaFirmaPorParteFiduciaria' ).value !== null">
    <p class="align-text"><small><i>Adjunte el contrato suscrito cuando tenga todas las firmas requeridas.</i></small></p>
  </div>

  <div class="text-center" style="margin-top: 2em;">
    <button mat-button
            color="warn"
            class="btn-guardar"
            type="submit">
            <img  src="assets/img/icon/guardar.svg"
                  alt="Regresar">
    </button>
  </div>
</form>
