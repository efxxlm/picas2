<mat-card class="shipping-card var-main-gris mb-4em" *ngIf="novedad">
  <mat-card-header class="header-card header-card--margin">
    <mat-card-title class="header-card--text">
      Datos del contrato
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <p>
      <strong>
        Nombre del contratista:
      </strong>
      {{ novedad.contrato.contratacion.contratista.nombre }}
    </p>
    <p>
      <strong>Tipo de identificación:</strong>
      <span>
        {{ novedad.contrato.contratacion.contratista.tipoIdentificacionNotMapped }}
      </span>
    </p>
    <p>
      <strong>
        Número de identificación
      </strong>
      {{ novedad.contrato.contratacion.contratista.numeroIdentificacion }}
    </p>
    <p>
      <strong>Tipo de intervención:</strong>
      <span>
        {{ novedad.proyectosContrato[0].tipoIntervencion }}
      </span>
    </p>
    <p>
      <strong>Valor del contrato:</strong>
      <span>
        {{ novedad.proyectosContrato[0].valorTotal | currency:'COP':'symbol-narrow':'.0-0' }}
      </span>
    </p>
    <p>
      <strong>Plazo:</strong>
      <span>
        {{ novedad.contrato.contratacion.disponibilidadPresupuestal[novedad.contrato.contratacion.disponibilidadPresupuestal.length-1].plazoMeses }} Meses 
        {{ novedad.contrato.contratacion.disponibilidadPresupuestal[novedad.contrato.contratacion.disponibilidadPresupuestal.length-1].plazoDias }} Días 
      </span>
    </p>
    <p>
      <strong>Fecha de inicio de contrato:</strong>
      {{ (novedad.contrato?.fechaActaInicioFase2 ? novedad.contrato?.fechaActaInicioFase2 : novedad.contrato?.fechaActaInicioFase1) | date:'dd/MM/yyyy'}}
    </p>
    <p>
      <strong>Fecha de finalización de contrato:</strong>
      {{ (novedad.contrato?.fechaTerminacionFase2 ? novedad.contrato?.fechaTerminacionFase2 : novedad.contrato?.fechaTerminacion) | date:'dd/MM/yyyy'}}
    </p>

    <div *ngIf="novedad.esAplicadaAcontrato !== true">
    <h2 class="card-subTitle">Proyecto asociado</h2>
    <div class="table-responsive mb-2em px-table">
      <table class="mat-table cdk-table mat-sort mat-table-style table-form table-form--2 table-gris">
        <thead>
          <tr class="mat-header-row cdk-header-row ng-star-inserted">
            <th class="mat-header-cell cdk-header-cell ng-star-inserted">
              Llave MEN
            </th>
            <th class="mat-header-cell cdk-header-cell ng-star-inserted">
              Departamento
            </th>
            <th class="mat-header-cell cdk-header-cell ng-star-inserted">
              Municipio
            </th>
            <th class="mat-header-cell cdk-header-cell ng-star-inserted">
              Institucion Educativa
            </th>
            <th class="mat-header-cell cdk-header-cell ng-star-inserted">
              Sede
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="mat-cell cdk-cell ng-star-inserted">
              {{ novedad.proyectosSeleccionado.llaveMen }}
            </td>
            <td class="mat-cell cdk-cell ng-star-inserted">
              {{ novedad.proyectosSeleccionado.departamento }}
            </td>
            <td class="mat-cell cdk-cell ng-star-inserted">
              {{ novedad.proyectosSeleccionado.municipio }}
            </td>
            <td class="mat-cell cdk-cell ng-star-inserted">
              {{ novedad.proyectosSeleccionado.institucionEducativa }}
            </td>
            <td class="mat-cell cdk-cell ng-star-inserted">
              {{ novedad.proyectosSeleccionado.sede }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    </div>
  </mat-card-content>
</mat-card>

<mat-card class="shipping-card var-main-gris" *ngIf="novedad">
  <mat-card-header class="header-card header-card--margin">
    <mat-card-title class="header-card--text">
      Registro de novedad
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <p>
      <strong>
        Fecha de solicitud de la novedad:
      </strong>
      {{ novedad.fechaSolictud | date: 'dd/MM/yyyy' }}
    </p>
    <p>
      <strong>
        Instancia donde se presentó la solicitud:
      </strong>
      <span>
        {{ novedad.instanciaNombre }}
      </span>
    </p>
    <p *ngIf="novedad.instanciaNombre !== 'No aplica'">
      <strong>
        Fecha de la sesión de la instancia:
      </strong>
      {{ novedad.fechaSesionInstancia | date: 'dd/MM/yyyy' }}
    </p>
    <p>
      <strong>
        Tipo de novedad:
      </strong>
     {{ tipoNovedadNombre }}
    </p>

  </mat-card-content>
</mat-card>
<mat-accordion *ngIf="novedad">
  <mat-expansion-panel class="expansion-style sub-expansion" *ngFor=" let descripcion of novedad.novedadContractualDescripcion; let i = index; ">
    <mat-expansion-panel-header class="expansion-style--header">
      <mat-panel-title class="expansion-style--title">
        Novedad {{ 1 + i }}
      </mat-panel-title>
    </mat-expansion-panel-header>
    <mat-card class="shipping-card var-main-gris">
      <mat-card-header class="header-card header-card--margin">
        <mat-card-title class="header-card--text textoGris">
          {{ descripcion.nombreTipoNovedad }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <strong>Motivos de la novedad:</strong> 
            <section *ngFor="let motivo of descripcion.novedadContractualDescripcionMotivo;"> {{ motivo.nombreMotivo}}, </section> 
        
        <p><strong>Resumen de la justificación de la novedad: </strong></p>
          <section 
                  [innerHTML]="descripcion.resumenJustificacion"
                  style="margin-left: 2em"
          ></section>
        <mat-card-title class="header-card--text sub-text" *ngIf="descripcion.tipoNovedadCodigo == '4'">
          Plazo solicitado
        </mat-card-title>
        <p *ngIf="descripcion.tipoNovedadCodigo == '4'"><strong>plazo Adicional Meses: </strong> {{ descripcion.plazoAdicionalMeses }}</p>
        <p *ngIf="descripcion.tipoNovedadCodigo == '4'"><strong>plazo Adicional Días: </strong> {{ descripcion.plazoAdicionalDias }}</p>

        <p *ngIf="descripcion.tipoNovedadCodigo == '1' || descripcion.tipoNovedadCodigo == '2'"><strong>Fecha de inicio de la suspensión: </strong> {{ descripcion.fechaInicioSuspension | date: 'dd/MM/yyyy' }}</p>
        <p *ngIf="descripcion.tipoNovedadCodigo == '1' || descripcion.tipoNovedadCodigo == '2'"><strong>Fecha final de la suspensión: </strong> {{ descripcion.fechaFinSuspension | date: 'dd/MM/yyyy' }} </p>

        <p *ngIf="descripcion.tipoNovedadCodigo == '3'" ><strong>Presupuesto adicional solicitado: </strong> {{ descripcion.presupuestoAdicionalSolicitado }} </p>

        <section *ngIf="descripcion.tipoNovedadCodigo === '5'">
          <section *ngFor="let clausula of descripcion?.novedadContractualClausula; let i = index;">
            <h3> <strong> CLAUSULA </strong> {{ i + 1 }} </h3>
            <p><strong>Cláusula a modificar: </strong> </p>
            <section [innerHTML]="clausula.clausulaAmodificar" style="margin-left: 2em"></section>
            <p><strong>Ajuste solicitado a la cláusula: </strong> </p>
            <section [innerHTML]="clausula.ajusteSolicitadoAclausula" style="margin-left: 2em"></section>
          </section>
        </section>

        <p><strong>¿Cuenta con la documentación soporte suficiente?: </strong> {{ descripcion.esDocumentacionSoporte === true ? 'Sí' : 'No' }}</p>
        <p><strong>Concepto técnico: </strong></p>
        <section 
                  [innerHTML]="descripcion.conceptoTecnico"
                  style="margin-left: 2em"
          ></section>
        <p><strong>Fecha concepto técnico: </strong> {{ descripcion.fechaConcepto | date: 'dd/MM/yyyy' }}</p>
        <p><strong>Número de radicado en FFIE de solicitud: </strong> {{ descripcion.numeroRadicado }}</p>
      </mat-card-content>
    </mat-card>
  </mat-expansion-panel>
</mat-accordion>
