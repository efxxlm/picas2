<section *ngIf="esVerDetalle === false">
  <section *ngIf="esSiguienteSemana === false">
    <form autocomplete="off" [formGroup]="formActividadesRealizadas" (ngSubmit)="guardar()">
      <div align="left">
        <mat-card>
          <mat-card-content>
            <div class="row">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadas.get('actividadTecnica').invalid &&
                          formActividadesRealizadas.get('actividadTecnica').touched) ||
                        (formActividadesRealizadas.get('actividadTecnica').invalid && esRegistroNuevo === false)
                      "
                    >
                      Técnicas
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadas.get('actividadTecnica').invalid &&
                          formActividadesRealizadas.get('actividadTecnica').touched) ||
                        (formActividadesRealizadas.get('actividadTecnica').invalid && esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadTecnica"
                      #obsTecnica
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadTecnica').value !== null"
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsTecnica.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadTecnica').value === null"
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadas.get('actividadTecnica').invalid &&
                            formActividadesRealizadas.get('actividadTecnica').touched) ||
                          (formActividadesRealizadas.get('actividadTecnica').invalid && esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-1em">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadas.get('actividadLegal').invalid &&
                          formActividadesRealizadas.get('actividadLegal').touched) ||
                        (formActividadesRealizadas.get('actividadLegal').invalid && esRegistroNuevo === false)
                      "
                    >
                      Legales
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadas.get('actividadLegal').invalid &&
                          formActividadesRealizadas.get('actividadLegal').touched) ||
                        (formActividadesRealizadas.get('actividadLegal').invalid && esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadLegal"
                      #obsLegales
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadLegal').value !== null"
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsLegales.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadLegal').value === null"
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadas.get('actividadLegal').invalid &&
                            formActividadesRealizadas.get('actividadLegal').touched) ||
                          (formActividadesRealizadas.get('actividadLegal').invalid && esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-1em mb-1em">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                          formActividadesRealizadas.get('actividadAdministrativaFinanciera').touched) ||
                        (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                          esRegistroNuevo === false)
                      "
                    >
                      Administrativas - Financieras
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                          formActividadesRealizadas.get('actividadAdministrativaFinanciera').touched) ||
                        (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                          esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadAdministrativaFinanciera"
                      #obsAdministrativa
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadAdministrativaFinanciera').value !== null"
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsAdministrativa.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadas.get('actividadAdministrativaFinanciera').value === null"
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                            formActividadesRealizadas.get('actividadAdministrativaFinanciera').touched) ||
                          (formActividadesRealizadas.get('actividadAdministrativaFinanciera').invalid &&
                            esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
      <div class="text-center" style="margin-top: 2em">
        <button
          mat-button
          color="warn"
          class="btn-guardar"
          type="submit"
          [disabled]="formActividadesRealizadas.dirty === false"
        >
          <img src="assets/img/icon/guardar.svg" />
        </button>
      </div>
    </form>

    <section class="text-center table-responsive size-table" style="margin-top: 2em" *ngIf="dataHistorial.length > 0">
      <table mat-table [dataSource]="tablaHistorial" matSort>
        <ng-container matColumnDef="fechaRevision">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color">Fecha de revisión</th>
          <td mat-cell *matCellDef="let element" align="center" class="color-text">
            <b>{{ element.fechaCreacion | date: 'dd/MM/yyyy' }}</b>
          </td>
        </ng-container>

        <ng-container matColumnDef="responsable">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color w-20">
            Responsable de la observación
          </th>
          <td mat-cell *matCellDef="let element" align="center" class="color-text">
            <ng-container *ngIf="element.esSupervisor === true; else noEsSupervisor">
              <p>Supervisor</p>
            </ng-container>
            <ng-template #noEsSupervisor>
              <p>Apoyo a la supervisión</p>
            </ng-template>
          </td>
        </ng-container>

        <ng-container matColumnDef="historial">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color">Historial de observaciones</th>
          <td mat-cell *matCellDef="let element" align="center" class="color-text">
            <section [innerHTML]="element.observacion"></section>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsHistorial"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsHistorial"></tr>
      </table>
    </section>
  </section>

  <section *ngIf="esSiguienteSemana === true">
    <form autocomplete="off" [formGroup]="formActividadesRealizadasSiguienteSemana" (ngSubmit)="guardar()">
      <div align="left">
        <mat-card>
          <mat-card-content>
            <div class="row">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                          esRegistroNuevo === false)
                      "
                    >
                      Técnicas
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                          esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadTecnicaSiguiente"
                      #obsTecnica
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').value !== null"
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsTecnica.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').value === null"
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                            formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').touched) ||
                          (formActividadesRealizadasSiguienteSemana.get('actividadTecnicaSiguiente').invalid &&
                            esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-1em">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                          esRegistroNuevo === false)
                      "
                    >
                      Legales
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                          esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadLegalSiguiente"
                      #obsLegales
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').value !== null"
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsLegales.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').value === null"
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                            formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').touched) ||
                          (formActividadesRealizadasSiguienteSemana.get('actividadLegalSiguiente').invalid &&
                            esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-1em mb-1em">
              <div class="col-md-12">
                <div>
                  <div class="pr-1">
                    <label
                      class="label-left"
                      [class.color-secondaryColor]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                            .touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .invalid &&
                          esRegistroNuevo === false)
                      "
                    >
                      Administrativas - Financieras
                    </label>
                  </div>
                  <div class="col d-flex" style="width: 100%">
                    <quill-editor
                      class="quill-editor-style card position-relative"
                      [class.invalid]="
                        (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .invalid &&
                          formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                            .touched) ||
                        (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .invalid &&
                          esRegistroNuevo === false)
                      "
                      [styles]="editorStyle"
                      [modules]="config"
                      style="width: 100%"
                      (onContentChanged)="maxLength($event, 2000)"
                      formControlName="actividadAdministrativaFinancieraSiguiente"
                      #obsAdministrativa
                      required
                    >
                    </quill-editor>
                    <span
                      class="contador miles"
                      *ngIf="
                        formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .value !== null
                      "
                      style="margin-top: 3.5em"
                    >
                      {{ 2000 - textoLimpio(obsAdministrativa.quillEditor, 2000) }}
                    </span>
                    <span
                      class="contador miles"
                      *ngIf="
                        formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                          .value === null
                      "
                      style="margin-top: 3.5em"
                    >
                      2000
                    </span>
                    <span class="icon-incompleto" style="margin-top: 3.6em">
                      <img
                        class="icon-incompleto--img"
                        src="assets/img/icon/incompleto.svg"
                        alt="este campo es requerido"
                        [matTooltipPosition]="'above'"
                        matTooltip="Debe ingresar la información en el campo para continuar"
                        matTooltipClass="info-tooltip"
                        *ngIf="
                          (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                            .invalid &&
                            formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                              .touched) ||
                          (formActividadesRealizadasSiguienteSemana.get('actividadAdministrativaFinancieraSiguiente')
                            .invalid &&
                            esRegistroNuevo === false)
                        "
                      />
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
      <div class="text-center" style="margin-top: 2em">
        <button
          mat-button
          color="warn"
          class="btn-guardar"
          type="submit"
          [disabled]="formActividadesRealizadasSiguienteSemana.dirty === false"
        >
          <img src="assets/img/icon/guardar.svg" />
        </button>
      </div>
    </form>
  </section>

  <section
    class="text-center table-responsive size-table"
    style="margin-top: 2em"
    *ngIf="dataHistorialSiguiente.length > 0"
  >
    <table mat-table [dataSource]="tablaHistorialSiguiente" matSort>
      <ng-container matColumnDef="fechaRevision">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color">Fecha de revisión</th>
        <td mat-cell *matCellDef="let element" align="center" class="color-text">
          <b>{{ element.fechaCreacion | date: 'dd/MM/yyyy' }}</b>
        </td>
      </ng-container>

      <ng-container matColumnDef="responsable">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color w-20">Responsable de la observación</th>
        <td mat-cell *matCellDef="let element" align="center" class="color-text">
          <ng-container *ngIf="element.esSupervisor === true; else noEsSupervisor">
            <p>Supervisor</p>
          </ng-container>
          <ng-template #noEsSupervisor>
            <p>Apoyo a la supervisión</p>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="historial">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="back-color">Historial de observaciones</th>
        <td mat-cell *matCellDef="let element" align="center" class="color-text">
          <section [innerHTML]="element.observacion"></section>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsHistorial"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsHistorial"></tr>
    </table>
  </section>
</section>

<!-- Ver detalle -->
<section *ngIf="esVerDetalle === true && reporteActividad !== undefined">
  <section *ngIf="esSiguienteSemana === false">
    <div align="left">
      <mat-card class="border">
        <mat-card-content class="mt-1em">
          <section>
            <p><b>Técnicas</b></p>
            <div [innerHTML]="reporteActividad.actividadTecnica"></div>
          </section>

          <section>
            <p><b>Legales</b></p>
            <div [innerHTML]="reporteActividad.actividadLegal"></div>
          </section>

          <section>
            <p><b>Administrativas - Financieras</b></p>
            <div [innerHTML]="reporteActividad.actividadAdministrativaFinanciera"></div>
          </section>
        </mat-card-content>
      </mat-card>
    </div>
  </section>
  <section *ngIf="esSiguienteSemana === true">
    <div align="left">
      <mat-card class="border">
        <mat-card-content class="mt-1em">
          <section>
            <p><b>Técnicas</b></p>
            <div [innerHTML]="reporteActividad.actividadTecnicaSiguiente"></div>
          </section>

          <section>
            <p><b>Legales</b></p>
            <div [innerHTML]="reporteActividad.actividadLegalSiguiente"></div>
          </section>

          <section>
            <p><b>Administrativas - Financieras</b></p>
            <div [innerHTML]="reporteActividad.actividadAdministrativaFinancieraSiguiente"></div>
          </section>
        </mat-card-content>
      </mat-card>
    </div>
  </section>
</section>
