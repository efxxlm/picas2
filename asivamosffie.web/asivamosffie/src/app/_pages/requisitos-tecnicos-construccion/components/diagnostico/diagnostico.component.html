<form autocomplete="off" [formGroup]="formDiagnostico" (ngSubmit)="enviar()">
  <mat-card>
    <mat-card-content>

      <section class="example-section">
        <label class="example-margin"
        [ngClass]="{'color-secondaryColor' : formDiagnostico.get('esInformeDiagnostico').invalid && formDiagnostico.get('esInformeDiagnostico').dirty|| formDiagnostico.get('esInformeDiagnostico').invalid && estaEditando}">
        <b>¿Cuenta con informe de diagnóstico aprobado por la interventoría?</b>
      </label>
        <mat-radio-group formControlName="esInformeDiagnostico">
          <mat-radio-button class="example-margin" [value]="true" [checked]="formDiagnostico.get( 'esInformeDiagnostico' ).value === true">Sí</mat-radio-button>
          <mat-radio-button class="example-margin" [value]="false" [checked]="formDiagnostico.get( 'esInformeDiagnostico' ).value === false">No</mat-radio-button>
        </mat-radio-group>
        <span class="required-form-group m-0">*</span>
      </section>

      <section class="animatedDown" *ngIf="formDiagnostico.get( 'esInformeDiagnostico' ).value">
        <div class="d-flex mt-1em">
          <label class="mr-label" class="label-left"
          [ngClass]="{'color-secondaryColor' : formDiagnostico.get('rutaInforme').invalid && formDiagnostico.get('rutaInforme').dirty|| formDiagnostico.get('rutaInforme').invalid && estaEditando}">
            <b>URL con soporte</b>
          </label>
        <div class="col d-flex w-80">
          <mat-form-field>
            <input matInput type="text" formControlName="rutaInforme" required>
          </mat-form-field>
        </div>
      </div>
      <p class="text-center cursivayeso">Indique la ruta del soporte de esta información</p>
      </section>

    </mat-card-content>
  </mat-card>

  <section>
    <div>
      <mat-card>
        <mat-card-header class="header-card header-card--margin">
          <mat-card-title class="header-card--text">
            Valor total de la fase 2 construcción
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>

            <div class="d-flex">
              <label class="mr-label" class="label-left"
              [ngClass]="{'color-secondaryColor' : formDiagnostico.get('costoDirecto').invalid && formDiagnostico.get('costoDirecto').dirty|| formDiagnostico.get('costoDirecto').invalid && estaEditando}">
                <b>a.</b> Costo directo
              </label>
            <div class="col d-flex">
              <mat-form-field style="width: 35.5%;">
                <input  matInput
                        maxlength="28"
                        formControlName="costoDirecto"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: 0, align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'costoDirecto' ).value !== null">
                {{20 - formDiagnostico.get( 'costoDirecto' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'costoDirecto' ).value === null">
                20
              </span>
            </div>
          </div>

            <div class="d-flex">
              <label class="mr-label" class="label-left"
              [ngClass]="{'color-secondaryColor' : formDiagnostico.get('administracion').invalid && formDiagnostico.get('administracion').dirty|| formDiagnostico.get('administracion').invalid && estaEditando}">
                <b>b.</b> A (administración)
              </label>
            <div class="col d-flex">
              <mat-form-field style="width: 33.5%;">
                <input  matInput
                        maxlength="28"
                        formControlName="administracion"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'administracion' ).value !== null">
                {{20 - formDiagnostico.get( 'administracion' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'administracion' ).value === null">
                20
              </span>
            </div>
          </div>

            <div class="d-flex">
              <label class="mr-label" class="label-left"
              [ngClass]="{'color-secondaryColor' : formDiagnostico.get('imprevistos').invalid && formDiagnostico.get('imprevistos').dirty|| formDiagnostico.get('imprevistos').invalid && estaEditando}">
                <b>c.</b> I (Imprevistos)
              </label>
            <div class="col d-flex">
              <mat-form-field style="width: 35.1%;">
                <input  matInput
                        maxlength="28"
                        formControlName="imprevistos"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'imprevistos' ).value !== null">
                {{20 - formDiagnostico.get( 'imprevistos' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'imprevistos' ).value === null">
                20
              </span>
            </div>
          </div>

            <div class="d-flex">
              <label class="mr-label" class="label-left"
              [ngClass]="{'color-secondaryColor' : formDiagnostico.get('utilidad').invalid && formDiagnostico.get('utilidad').dirty|| formDiagnostico.get('utilidad').invalid && estaEditando}">
                <b>d.</b> U (Utilidad)
              </label>
            <div class="col d-flex">
              <mat-form-field style="width: 36.3%;">
                <input  matInput
                        maxlength="28"
                        formControlName="utilidad"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'utilidad' ).value !== null">
                {{20 - formDiagnostico.get( 'utilidad' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'utilidad' ).value === null">
                20
              </span>
            </div>
          </div>

            <div class="d-flex">
              <label class="mr-label" class="label-left">
                <b>Valor total de la fase 2 - Construcción</b>
              </label>
            <div class="col d-flex">
              <mat-form-field style="width: 29%;">
                <input  matInput
                        formControlName="valorTotalFaseConstruccion"
                        currencyMask
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }"
                        #valorTotalFaseConstruccion>
              </mat-form-field>
            </div>
          </div>

        </mat-card-content>
      </mat-card>
    </div>
  </section>

  <section *ngIf="valorTotalFaseConstruccion.value.length > 0">
    <div *ngIf="( formDiagnostico.get( 'costoDirecto' ).value !== null ) && ( formDiagnostico.get( 'administracion' ).value !== null )">
      <div *ngIf="( formDiagnostico.get( 'imprevistos' ).value !== null ) && ( formDiagnostico.get( 'utilidad' ).value !== null )">

        <div class="example-section text-center">
          <label class="example-margin"
          [ngClass]="{'color-secondaryColor' : formDiagnostico.get('requiereModificacionContractual').invalid && formDiagnostico.get('requiereModificacionContractual').dirty|| formDiagnostico.get('requiereModificacionContractual').invalid && estaEditando}">
            <b>¿Se requirió modificación contractual?</b>
          </label>
          <mat-radio-group formControlName="requiereModificacionContractual">
            <mat-radio-button class="example-margin" [value]="true" [checked]="formDiagnostico.get( 'requiereModificacionContractual' ).value">Sí</mat-radio-button>
            <mat-radio-button class="example-margin" [value]="false" [checked]="formDiagnostico.get( 'requiereModificacionContractual' ).value === false">No</mat-radio-button>
          </mat-radio-group>
          <span class="required-form-group m-0">*</span>
        </div>

        <mat-card *ngIf="formDiagnostico.get( 'requiereModificacionContractual' ).value">
          <mat-card-content>
            <div class="example-section-left w-70 mt-min" align="left">
              <p
              [ngClass]="{'color-secondaryColor' : formDiagnostico.get('numeroSolicitudModificacion').invalid && formDiagnostico.get('numeroSolicitudModificacion').dirty|| formDiagnostico.get('numeroSolicitudModificacion').invalid && estaEditando}">
                <b>Número de solicitud de la modificación</b>
              </p>
              <mat-form-field class="w-40 mr-min">
                <mat-select formControlName="numeroSolicitudModificacion" class="padding-left">
                  <mat-option></mat-option>
                  <mat-option *ngFor="let solicitud of solicitudesModificacion" [value]="solicitud.value">
                    {{solicitud.viewValue}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </mat-card-content>
        </mat-card>

      </div>
    </div>
  </section>

  <div class="text-center">
    <button mat-button
            color="warn"
            class="btn-guardar"
            type="submit">
            <img  src="assets/img/icon/guardar.svg">
    </button>
  </div>
</form>
<div align="center" *ngIf="contratoConstruccion && contratoConstruccion.observacionDevolucionDiagnostico">
  <mat-card class="border" style="margin-top: 20px;">
      <mat-card-header class="header-card">
          <mat-card-title class="header-card--text grayTitle">
            Observaciones de la supervisión
          </mat-card-title>
      </mat-card-header>
      <mat-card-content align="left" >
          <p style="margin-left: 2em;"><b>{{ contratoConstruccion.observacionDevolucionDiagnostico.fechaCreacion | date: "dd/MM/yyyy" }}</b></p>
          <p style="margin-left: 2em;"><b>¿Tiene observaciones al diagnóstico?:</b> Sí</p>
          <section [innerHTML]="contratoConstruccion.observacionDevolucionDiagnostico.observaciones" style="margin-left: 2em;"></section>
      </mat-card-content>
  </mat-card>
</div>
