<form autocomplete="off" [formGroup]="formDiagnostico" (ngSubmit)="enviar()">
  <mat-card>
    <mat-card-content>
      
      <section class="example-section">
        <label class="example-margin"> <b>¿Cuenta con informe de diagnóstico aprobado por la interventoría?</b> </label>
        <mat-radio-group formControlName="esInformeDiagnostico">
          <mat-radio-button class="example-margin" [value]="true" [checked]="formDiagnostico.get( 'esInformeDiagnostico' ).value === true">Sí</mat-radio-button>
          <mat-radio-button class="example-margin" [value]="false" [checked]="formDiagnostico.get( 'esInformeDiagnostico' ).value === false">No *</mat-radio-button>
        </mat-radio-group>
      </section>
  
      <section *ngIf="formDiagnostico.get( 'esInformeDiagnostico' ).value">
        <div class="d-flex mt-1em">
          <label class="mr-label" class="label-left"><b>Url con soporte</b></label>
        <div class="col d-flex w-80">
          <mat-form-field>
            <input matInput type="text" formControlName="rutaInforme" required>
          </mat-form-field>
        </div>
      </div>
      <span class="color-secundary">Indique la ruta del soporte de esta información</span>
      </section>
  
    </mat-card-content>
  </mat-card>

  <section>
    <div>
      <mat-card>
        <mat-card-header class="header-card">
          <mat-card-title class="header-card--text">
            Valor total de la fase 2 construcción
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          
          <section>
            <div class="d-flex mt-1em">
              <label class="mr-label" class="label-left"><b>a.</b> Costo directo</label>
            <div class="col d-flex">
              <mat-form-field style="width: 35.5%;">
                <input  matInput
                        maxlength="28"
                        formControlName="costoDirecto"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: 0, align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'costoDirecto' ).value !== null">
                {{20 - formDiagnostico.get( 'costoDirecto' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'costoDirecto' ).value === null">
                20
              </span>
            </div>
          </div>
          </section>
  
          <section>
            <div class="d-flex mt-1em">
              <label class="mr-label" class="label-left"><b>b.</b> A (administración)</label>
            <div class="col d-flex">
              <mat-form-field style="width: 33.5%;">
                <input  matInput
                        maxlength="28"
                        formControlName="administracion"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'administracion' ).value !== null">
                {{20 - formDiagnostico.get( 'administracion' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'administracion' ).value === null">
                20
              </span>
            </div>
          </div>
          </section>
  
          <section>
            <div class="d-flex mt-1em">
              <label class="mr-label" class="label-left"><b>c.</b> I (Imprevistos)</label>
            <div class="col d-flex">
              <mat-form-field style="width: 35%;">
                <input  matInput
                        maxlength="28"
                        formControlName="imprevistos"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'imprevistos' ).value !== null">
                {{20 - formDiagnostico.get( 'imprevistos' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'imprevistos' ).value === null">
                20
              </span>
            </div>
          </div>
          </section>
  
          <section>
            <div class="d-flex mt-1em">
              <label class="mr-label" class="label-left"><b>d.</b> U (Utilidad)</label>
            <div class="col d-flex">
              <mat-form-field style="width: 36%;">
                <input  matInput
                        maxlength="28"
                        formControlName="utilidad"
                        currencyMask
                        required
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }">
              </mat-form-field>
              <span class="contador" *ngIf="formDiagnostico.get( 'utilidad' ).value !== null">
                {{20 - formDiagnostico.get( 'utilidad' ).value.toString().length}}
              </span>
              <span class="contador" *ngIf="formDiagnostico.get( 'utilidad' ).value === null">
                20
              </span>
            </div>
          </div>
          </section>
  
          <section>
            <div class="d-flex mt-1em">
              <label class="mr-label" class="label-left"><b>Valor total de la fase 2 - Construcción</b></label>
            <div class="col d-flex">
              <mat-form-field style="width: 29%;">
                <input  matInput
                        formControlName="valorTotalFaseConstruccion"
                        currencyMask
                        [options]="{ prefix: '$ ', thousands: ',', precision: '0', align: 'center' }"
                        #valorTotalFaseConstruccion>
              </mat-form-field>
            </div>
          </div>
          </section>
  
        </mat-card-content>
      </mat-card>
    </div>
  </section>

  <section *ngIf="valorTotalFaseConstruccion.value.length > 0">
    <div *ngIf="( formDiagnostico.get( 'costoDirecto' ).value !== null ) && ( formDiagnostico.get( 'administracion' ).value !== null )">
      <div *ngIf="( formDiagnostico.get( 'imprevistos' ).value !== null ) && ( formDiagnostico.get( 'utilidad' ).value !== null )">

        <div class="example-section text-center">
          <label class="example-margin"> <b>¿Se requirió modificación contractual?</b> </label>
          <mat-radio-group formControlName="requiereModificacionContractual">
            <mat-radio-button class="example-margin" [value]="true" [checked]="formDiagnostico.get( 'requiereModificacionContractual' ).value">Sí</mat-radio-button>
            <mat-radio-button class="example-margin" [value]="false" [checked]="formDiagnostico.get( 'requiereModificacionContractual' ).value === false">No *</mat-radio-button>
          </mat-radio-group>
        </div>

        <mat-card *ngIf="formDiagnostico.get( 'requiereModificacionContractual' ).value">
          <mat-card-content>
            <div class="example-section-left w-70 mt-min" align="left">
              <p>Número de solicitud de la modificación</p>
              <mat-form-field class="w-40 mr-min" appearance="fill">
                <mat-select formControlName="numeroSolicitudModificacion" class="padding-left">
                  <mat-option></mat-option>
                  <mat-option *ngFor="let solicitud of solicitudesModificacion" [value]="solicitud.value">
                    {{solicitud.viewValue}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </mat-card-content>
        </mat-card>

      </div>
    </div>
  </section>

  <div class="text-center">
    <button mat-button 
            color="warn" 
            class="btn-guardar" 
            type="submit">
            <img  src="assets/img/icon/guardar.svg">
    </button>
  </div>
</form>
<div align="center" *ngIf="contratoConstruccion && contratoConstruccion.observacionDevolucionDiagnostico">
  <mat-card class="border" style="margin-top: 20px;">
      <mat-card-header class="header-card">
          <mat-card-title class="header-card--text grayTitle">
            Observaciones de la supervisión
          </mat-card-title>
      </mat-card-header>
      <mat-card-content align="left" >
          <p><b>{{ contratoConstruccion.observacionDevolucionDiagnostico.fechaCreacion | date: "dd/MM/yyyy" }}</b></p>
          <p><b>¿Tiene observaciones al diagnóstico?:</b> Sí</p>
          <p>{{ contratoConstruccion.observacionDevolucionDiagnostico.observaciones }}</p>
      </mat-card-content>
  </mat-card>
</div>
