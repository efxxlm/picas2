<section *ngIf="solicitudPago !== undefined">
    <div class="table-responsive">
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
            <ng-container matColumnDef="llaveMen">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Llave MEN </th>
                <td mat-cell *matCellDef="let element" align="center"> <b>{{ element.llaveMen }}</b> </td>
            </ng-container>
            <ng-container matColumnDef="tipoIntervencion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo de intervenci칩n </th>
                <td mat-cell *matCellDef="let element" align="center"> {{ element.tipoIntervencion }} </td>
            </ng-container>
            <ng-container matColumnDef="departamento">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Departamento </th>
                <td mat-cell *matCellDef="let element" align="center"> {{ element.departamento }} </td>
            </ng-container>
            <ng-container matColumnDef="municipio">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Municipio </th>
                <td mat-cell *matCellDef="let element" align="center"> {{ element.municipio }} </td>
            </ng-container>
            <ng-container matColumnDef="institucionEducativa">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Instituci칩n educativa </th>
                <td mat-cell *matCellDef="let element" align="center"> {{ element.institucionEducativa }} </td>
            </ng-container>
            <ng-container matColumnDef="sede">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Sede </th>
                <td mat-cell *matCellDef="let element" align="center"> {{ element.sede }} </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>

    <ng-container *ngIf="esMultiProyecto === true; else noEsMultiProyecto">
        <form [formGroup]="addressForm">
            <div formArrayName="projects" style="margin-top: 3em;" *ngIf="projects.length > 0">
                <div *ngFor="let project of projects.controls; index as i" [formGroup]="project">
                    <mat-card class="shipping-card var-main-gris">
                        <mat-card-header class="header-card header-card--margin">
                            <mat-card-title class="header-card--text">
                                {{ project.get( 'llaveMen' ).value }}
                            </mat-card-title>
                        </mat-card-header>
                        <mat-card-content style="text-align: left;">
                            <p><strong>Monto m치ximo a pagar en el proyecto:</strong> {{ project.get( 'valorMaximoProyecto' ).value | currency:'':'symbol-narrow':'.0-0' }} </p>
                            <p><strong>Monto pendiente a pagar en el proyecto:</strong> {{ project.get( 'valorPendienteProyecto' ).value | currency:'':'symbol-narrow':'.0-0' }} </p>
                            <br>
                            <br>
                            <div class="d-flex">
                                <strong>Criterios:</strong>
                                <div class="d-flex">
                                    <strong>Criterios:</strong>
                                    <p *ngFor="let criterio of project.get( 'criterioPago' ).value; index as i" style="margin-left: .4em;"> {{ criterio.nombre }}<span *ngIf="project.get( 'criterioPago' ).value.length - 1 !== i">,</span><span *ngIf="project.get( 'criterioPago' ).value.length - 1 === i">.</span> </p>
                                </div>
                            </div>
                            <section formArrayName="criteriosProyecto" class="mt-1em" *ngIf="criteriosProyecto( i ).length > 0">
                                <div *ngFor="let criterioProyecto of criteriosProyecto( i ).controls; index as j" [formGroup]="criterioProyecto">
                                    <div style="font-size: 16px;">
                                        <b> {{ criterioProyecto.get( 'nombre' ).value }} </b>
                                    </div>
                                    <p><strong>Valor facturado para el proyecto en el criterio:</strong> ${{ criterioProyecto.get( 'valorFacturado' ).value | currency:' ':'symbol-narrow':'.0-0' }} </p>
                                </div>
                            </section>
                        </mat-card-content>
                    </mat-card>
                </div>
            </div>
        </form>
    </ng-container>
    <ng-template #noEsMultiProyecto>
        <div style="margin-top: 3em;" *ngIf="proyectos !== undefined && montoMaximo !== undefined">
            <mat-card class="shipping-card var-main-gris" *ngFor="let proyecto of proyectos">
                <mat-card-header class="header-card header-card--margin">
                    <mat-card-title class="header-card--text">
                        {{ proyecto.llaveMen }}
                    </mat-card-title>
                </mat-card-header>
                <mat-card-content style="text-align: left;">
                    <p><strong>Monto m치ximo a pagar en el proyecto:</strong> {{ montoMaximo.valorMaximoProyecto | currency:'':'symbol-narrow':'.0-0' }} </p>
                    <p><strong>Monto pendiente a pagar en el proyecto:</strong> {{ montoMaximo.valorPendienteProyecto | currency:'':'symbol-narrow':'.0-0' }} </p>
                    <br>
                    <div class="d-flex">
                        <strong>Criterio:</strong>
                        <section>
                            <p *ngFor="let criterio of criteriosArraySeleccionados; index as i" style="margin-left: .4em;"> {{ filterCriterios( criterio.codigo ) }}<span *ngIf="criteriosArraySeleccionados.length - 1 !== i">,</span><span *ngIf="criteriosArraySeleccionados.length - 1 === i">.</span> </p>
                        </section>
                    </div>
                    <br>
                    <div *ngFor="let criterio of solicitudPagoFaseCriterio">
                        <div style="font-size: 16px;">
                            <b> {{ filterCriterios( criterio.tipoCriterioCodigo ) }} </b>
                        </div>
                        <p><strong>Valor facturado para el proyecto en el criterio:</strong> ${{ criterio.valorFacturado | currency:' ':'symbol-narrow':'.0-0' }} </p>
                        <br>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </ng-template>
</section>