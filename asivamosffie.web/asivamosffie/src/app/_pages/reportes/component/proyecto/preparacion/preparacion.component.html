<section class="container mt-2em" *ngIf="this.dataPreparacion != null">
  <div class="container text-center">
    <div class="text-right">
      <a routerLink="../../../" mat-button color="primary" class="btn-regresar print-d-none">
        <img src="assets/img/icon/regresar.svg" alt="Regresar">
      </a>
    </div>
    <h1 class="title-menu--h1">
      Preparación {{ this.dataPreparacion?.informacion?.llaveMen }}
    </h1>
  </div>

  <mat-card class="shipping-card var-main-gris">
    <mat-card-content>
        <p>
          <strong>
            Institución Educativa:
          </strong>
          {{ this.dataPreparacion?.informacion?.institucionEducativa }}
        </p>
        <p>
          <strong>
            Sede:
          </strong>
          {{ this.dataPreparacion?.informacion?.sede }}
        </p>
        <p>
          <strong>
            Departamento:
          </strong>
          {{ this.dataPreparacion?.informacion?.departamento }}
        </p>
        <p>
          <strong>
            Municipio:
          </strong>
          {{ this.dataPreparacion?.informacion?.municipio }}
        </p>
    </mat-card-content>
  </mat-card>

  <mat-accordion [multi]="openAcordeon == true">
    <mat-expansion-panel class="expansion-style" [expanded]="openAcordeon == true">
      <mat-expansion-panel-header class="expansion-style--header">
        <mat-panel-title class="expansion-style--title">
          Fase 1- Preconstrucción
        </mat-panel-title>
      </mat-expansion-panel-header>

      <mat-accordion [multi]="openAcordeon == true">
        <mat-expansion-panel class="expansion-style sub-expansion" [expanded]="openAcordeon == true">
            <mat-expansion-panel-header class="expansion-style--header">
                <mat-panel-title class="expansion-style--title">
                  Contrato de obra {{ this.dataPreConstruccionObra?.numeroContrato }}
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="table-responsive mb-1em mt-1em">
              <table class="mat-table cdk-table mat-sort mat-table-style table-form table-gris table-reporte">
                <thead>
                  <tr class="mat-header-row cdk-header-row ng-star-inserted">
                    <th class="mat-header-cell cdk-header-cell ng-star-inserted">Perfil</th>
                    <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V requeridas</th>
                    <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V recibidas</th>
                    <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V aprobadas</th>
                    <th class="mat-header-cell cdk-header-cell ng-star-inserted">URL con soporte</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let element of this.dataPreConstruccionObra?.tablaPreconstruccion">
                    <td class="mat-cell cdk-cell ng-star-inserted">
                      <b> {{ element.nombrePerfil }} </b>
                    </td>
                    <td class="mat-cell cdk-cell ng-star-inserted">
                      {{ element.cantidadHvRequeridas }}
                    </td>
                    <td class="mat-cell cdk-cell ng-star-inserted">
                      {{ element.cantidadHvRecibidas }}
                    </td>
                    <td class="mat-cell cdk-cell ng-star-inserted">
                      {{ element.cantidadHvAprobadas }}
                    </td>
                    <td class="mat-cell cdk-cell ng-star-inserted">
                      {{ element.rutaSoporte }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <mat-card class="shipping-card var-main-gris">
              <mat-card-header class="header-card header-card--margin">
                <mat-card-title class="header-card--text">
                  Acta suscrita
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                  <p>
                    <strong>
                      {{ this.dataPreConstruccionObra?.actaSuscrita }}
                    </strong>
                  </p>
              </mat-card-content>
            </mat-card>

        </mat-expansion-panel>
    </mat-accordion>

    <mat-accordion [multi]="openAcordeon == true">
      <mat-expansion-panel class="expansion-style sub-expansion" [expanded]="openAcordeon == true">
          <mat-expansion-panel-header class="expansion-style--header">
              <mat-panel-title class="expansion-style--title">
                Contrato de interventoría {{ this.dataPreConstruccionInterventoria?.numeroContrato }}
              </mat-panel-title>
          </mat-expansion-panel-header>

          <div class="table-responsive mb-1em mt-1em">
            <table class="mat-table cdk-table mat-sort mat-table-style table-form table-gris table-reporte">
              <thead>
                <tr class="mat-header-row cdk-header-row ng-star-inserted">
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Perfil</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V requeridas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V recibidas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V aprobadas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">URL con soporte</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let element of this.dataPreConstruccionInterventoria?.tablaPreconstruccion">
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    <b> {{ element.nombrePerfil }} </b>
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvRequeridas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvRecibidas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvAprobadas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.rutaSoporte }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <mat-card class="shipping-card var-main-gris">
            <mat-card-header class="header-card header-card--margin">
              <mat-card-title class="header-card--text">
                Acta suscrita
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <p>
                  <strong>
                    {{ this.dataPreConstruccionInterventoria?.actaSuscrita }}
                  </strong>
                </p>
            </mat-card-content>
          </mat-card>

      </mat-expansion-panel>
    </mat-accordion>


    </mat-expansion-panel>
    <mat-expansion-panel class="expansion-style" [expanded]="openAcordeon == true">
      <mat-expansion-panel-header class="expansion-style--header">
        <mat-panel-title class="expansion-style--title">
          Fase 2 - Construcción
        </mat-panel-title>
      </mat-expansion-panel-header>

      <mat-accordion [multi]="openAcordeon == true">
        <mat-expansion-panel class="expansion-style sub-expansion" [expanded]="openAcordeon == true">
            <mat-expansion-panel-header class="expansion-style--header">
                <mat-panel-title class="expansion-style--title">
                  Contrato de obra {{ this.dataConstruccionObra?.numeroContrato }}
                </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-accordion [multi]="openAcordeon == true">
              <mat-expansion-panel class="expansion-style sub-expansion-black" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Diagnóstico
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-card class="shipping-card var-main-gris">
                    <mat-card-content>
                      <p>
                        <strong>
                          ¿Cuenta con informe de diagnóstico aprobado por la interventoría?:
                        </strong>
                        <span *ngIf="this.dataConstruccionObra?.diagnostico?.cuentaConInformeDiagnosticoAprobado == true">Sí</span>
                        <span *ngIf="this.dataConstruccionObra?.diagnostico?.cuentaConInformeDiagnosticoAprobado != true">No</span>
                      </p>
                      <p>
                        <strong>
                          URL con soporte:
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.urlSoporte }}
                      </p>
                    </mat-card-content>
                  </mat-card>

                  <mat-card class="shipping-card var-main-gris">
                    <mat-card-header class="header-card header-card--margin">
                      <mat-card-title class="header-card--text">
                        Valor total de la fase 2 construcción
                      </mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                      <p>
                        <strong>
                          a. Costo directo:
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.costoDirecto | currency:'COP':'symbol-narrow':'.0-0' }}
                      </p>
                      <p>
                        <strong>
                          b. A (administración):
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.administracion | currency:'COP':'symbol-narrow':'.0-0' }}
                      </p>
                      <p>
                        <strong>
                          c. I (Imprevistos):
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.imprevistos | currency:'COP':'symbol-narrow':'.0-0' }}
                      </p>
                      <p>
                        <strong>
                          d. U (Utilidad):
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.utilidad | currency:'COP':'symbol-narrow':'.0-0' }}
                      </p>
                      <p>
                        <strong>
                          Valor total de la fase 2 - Construcción:
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.valorTotalConstruccion | currency:'COP':'symbol-narrow':'.0-0' }}
                      </p>
                    </mat-card-content>
                  </mat-card>

                  <p class="text-center">
                    <strong>
                      ¿Se requirió modificación contractual?:
                    </strong>
                    <span *ngIf="this.dataConstruccionObra?.diagnostico?.tieneModificacionContractual == true">Sí</span>
                    <span *ngIf="this.dataConstruccionObra?.diagnostico?.tieneModificacionContractual != true">No</span>
                  </p>

                  <mat-card class="shipping-card var-main-gris" *ngIf="this.dataConstruccionObra?.diagnostico?.tieneModificacionContractual == true">
                    <mat-card-content>
                      <p>
                        <strong>
                          Número de solicitud de la modificación:
                        </strong>
                        {{ this.dataConstruccionObra?.diagnostico?.numeroModificacion }}
                      </p>
                    </mat-card-content>
                  </mat-card>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Planes y Programas
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <div class="table-responsive mb-1em mt-1em">
                    <table class="mat-table cdk-table mat-sort mat-table-style table-form table-gris">
                      <thead>
                        <tr class="mat-header-row cdk-header-row ng-star-inserted">
                          <th class="mat-header-cell cdk-header-cell ng-star-inserted">Planes y programas</th>
                          <th class="mat-header-cell cdk-header-cell ng-star-inserted">¿Se recibio el requisito?</th>
                          <th class="mat-header-cell cdk-header-cell ng-star-inserted">Fecha de radicado</th>
                          <th class="mat-header-cell cdk-header-cell ng-star-inserted">Fecha de aprobación</th>
                          <th class="mat-header-cell cdk-header-cell ng-star-inserted">¿Se tienen observaciones frente al requisito?</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let element of listaPlanes">
                          <td class="mat-cell cdk-cell ng-star-inserted">
                            <b> {{ element.nombre }} </b>
                          </td>
                          <td class="mat-cell cdk-cell ng-star-inserted">
                            <span *ngIf="element.recibioRequisito == true">Sí</span>
                            <span *ngIf="element.recibioRequisito == false">No</span>
                            <span *ngIf="element.recibioRequisito == '3'">No se requiere</span>
                          </td>
                          <td class="mat-cell cdk-cell ng-star-inserted">
                            {{ element.fechaRadicado | date: 'dd/MM/yyyy'}}
                          </td>
                          <td class="mat-cell cdk-cell ng-star-inserted">
                            {{ element.fechaAprobacion | date: 'dd/MM/yyyy'}}
                          </td>
                          <td class="mat-cell cdk-cell ng-star-inserted">
                            <span *ngIf="element.tieneObservaciones == true">Sí</span>
                            <span *ngIf="element.tieneObservaciones != true">No</span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <p>
                    <strong>
                      URL con soporte:
                    </strong>
                    {{ this.dataConstruccionObra?.planesYProgramas?.urlConSoporte }}
                  </p>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Manejo de anticipo
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-card class="shipping-card var-main-gris">
                    <mat-card-content>
                      <p>
                        <strong>
                          ¿El contrato requiere anticipo?:
                        </strong>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.requiereAnticipo == true">Sí</span>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.requiereAnticipo != true">No</span>
                      </p>
                      <p>
                        <strong>
                          ¿Cuenta con plan de inversión aprobado para el anticipo?:
                        </strong>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.tienePlanInversionAprobado == true">Sí</span>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.tienePlanInversionAprobado != true">No</span>
                      </p>
                      <p>
                        <strong>
                          ¿Cuenta con cronograma de amortización aprobado?:
                        </strong>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.tieneCronogramaAmortizacion == true">Sí</span>
                        <span *ngIf="dataConstruccionObra?.manejoAnticipo?.tieneCronogramaAmortizacion != true">No</span>
                      </p>
                    </mat-card-content>
                  </mat-card>

                  <p>
                    <strong>
                      URL con soporte:
                    </strong>
                    {{ dataConstruccionObra?.manejoAnticipo?.urlSoporte }}
                  </p>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Hojas de vida del contratista de obra
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-card class="shipping-card var-main-gris" *ngFor="let hv of dataConstruccionObra?.hojasDeVida; index as i;">
                    <mat-card-header class="header-card header-card--margin">
                      <mat-card-title class="header-card--text">
                        Perfil {{ i + 1 }}
                      </mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                      <p>
                        <strong>
                          Perfil:
                        </strong>
                        {{ hv.perfil }}
                      </p>
                      <p>
                        <strong>
                          Cantidad de hojas de vida requeridas para el perfil:
                        </strong>
                        {{ hv.cantidadHvRequeridas }}
                      </p>
                      <p>
                        <strong>
                          Cantidad de hojas de vida recibidas para el perfil:
                        </strong>
                        {{ hv.cantidadHvRecibidas }}
                      </p>
                      <p>
                        <strong>
                          Cantidad de hojas de vida aprobadas para el perfil:
                        </strong>
                        {{ hv.cantidadHvAprobadas }}
                      </p>
                      <p>
                        <strong>
                          Fecha de aprobación de la totalidad de las hojas de vida:
                        </strong>
                        {{ hv.fechaAprobacion }}
                      </p>
                      <p>
                        <strong>
                          Observaciones:
                        </strong>
                        <span class="d-block"  [innerHTML]="hv.observaciones">
                        </span>
                      </p>
                      <p *ngFor="let item of hv.listRadicados; index as j;">
                        <strong>
                          Número de radicado en FFIE de aprobación de hojas de vida {{ j + 1 }}:
                        </strong>
                        {{ item.numeroRadicado }}
                      </p>
                      <p>
                        <strong>
                          URL con soporte:
                        </strong>
                        {{ hv.rutaSoporte }}
                      </p>
                    </mat-card-content>
                  </mat-card>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black print-d-none" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Programación de obra
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <div class="text-center">
                    <button mat-raised-button color="accent" class="btn" (click)="descargar(false, dataConstruccionObra?.programacionObra?.rutaArchivo)">
                      Descargar archivo
                    </button>
                  </div>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black print-d-none" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Flujo de inversión de recursos
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <div class="text-center">
                    <button mat-raised-button color="accent" class="btn" (click)="descargar(true, dataConstruccionObra?.flujoInversion?.rutaArchivo)">
                      Descargar archivo
                    </button>
                  </div>

              </mat-expansion-panel>
              <mat-expansion-panel class="expansion-style sub-expansion-black" [expanded]="openAcordeon == true">
                  <mat-expansion-panel-header class="expansion-style--header">
                      <mat-panel-title class="expansion-style--title">
                        Acta suscrita
                      </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-card class="shipping-card var-main-gris">
                    <mat-card-header class="header-card header-card--margin">
                      <mat-card-title class="header-card--text">
                        Acta suscrita
                      </mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                      <p>
                        <strong>
                          {{ dataConstruccionObra?.actaSuscrita }}
                        </strong>
                      </p>
                    </mat-card-content>
                  </mat-card>

              </mat-expansion-panel>
          </mat-accordion>
        </mat-expansion-panel>
      </mat-accordion>
      <mat-accordion [multi]="openAcordeon == true">
        <mat-expansion-panel class="expansion-style sub-expansion" [expanded]="openAcordeon == true">
          <mat-expansion-panel-header class="expansion-style--header">
              <mat-panel-title class="expansion-style--title">
                Contrato de interventoría {{ dataConstruccionInterventoria?.numeroContrato }}
              </mat-panel-title>
          </mat-expansion-panel-header>

          <div class="table-responsive mb-1em mt-1em">
            <table class="mat-table cdk-table mat-sort mat-table-style table-form table-gris table-reporte">
              <thead>
                <tr class="mat-header-row cdk-header-row ng-star-inserted">
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Perfil</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V requeridas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V recibidas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">Cantidad de H.V aprobadas</th>
                  <th class="mat-header-cell cdk-header-cell ng-star-inserted">URL con soporte</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let element of dataConstruccionInterventoria?.hojasDeVida">
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    <b> {{ element.perfil }} </b>
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvRequeridas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvRecibidas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.cantidadHvAprobadas }}
                  </td>
                  <td class="mat-cell cdk-cell ng-star-inserted">
                    {{ element.rutaSoporte }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <mat-card class="shipping-card var-main-gris">
            <mat-card-header class="header-card header-card--margin">
              <mat-card-title class="header-card--text">
                Acta suscrita
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <p>
                  <strong>
                    {{ dataConstruccionInterventoria?.actaSuscrita }}
                  </strong>
                </p>
            </mat-card-content>
          </mat-card>
        </mat-expansion-panel>
      </mat-accordion>
    </mat-expansion-panel>
  </mat-accordion>
  <!--<div class="text-center mt-2em mb-2em print-d-none">
    <button mat-raised-button color="accent" (click)="downloadPDF();">Descargar</button>
  </div>-->
</section>
