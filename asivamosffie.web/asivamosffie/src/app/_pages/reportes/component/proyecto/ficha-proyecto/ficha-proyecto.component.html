<form [formGroup]="addressForm" novalidate (ngSubmit)="onSubmit()">
  <mat-card class="shipping-card">
    <mat-card-header class="header-card header-card--margin">
      <mat-card-title class="header-card--text">
        Ficha de proyecto
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="pr-1">
                  <label
                    class="label-left"
                    for="llaveMen"
                    [class.color-secondaryColor]="
                      addressForm.get('llaveMen').invalid && addressForm.get('llaveMen').touched
                    "
                    >
                    Llave MEN
                  </label>
                </div>
                <div class="col d-flex">
                    <mat-form-field
                        class="full-width"
                        [matTooltipPosition]="'above'"
                        matTooltip="Búsqueda sugerida, ingrese al menos un carácter"
                        matTooltipClass="info-tooltip"
                    >
                        <input matInput #llaveMen="matAutocompleteTrigger" type="text" maxlength="100" required [matAutocomplete]="auto" formControlName="llaveMen" (ngModelChange)="getProyectos($event)">
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let proyecto of proyectosArray" [value]="proyecto.llaveMen" (click)="seleccionAutocomplete(proyecto)">
                                {{ proyecto.llaveMen }}
                            </mat-option>
                        </mat-autocomplete>
                        <input type="hidden" formControlName="llaveMen">
                    </mat-form-field>
                    <button mat-button type="button" color="primary" class="busqueda--img" style="margin-bottom: 0 !important;padding-top: 0 !important;padding-bottom: 0 !important;">
                        <img src="assets/img/icon/lupa.svg" alt="Buscar">
                    </button>
                </div>
                <span class="icon-incompleto">
                    <img class="icon-incompleto--img" src="assets/img/icon/incompleto.svg" alt="este campo es requerido"
                      [matTooltipPosition]="'above'" matTooltip="Debe ingresar la información en el campo para continuar"
                      matTooltipClass="info-tooltip" *ngIf="addressForm.get('llaveMen').invalid && addressForm.get('llaveMen').touched" />
                </span>
            </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="departamento"
                [class.color-secondaryColor]="
                  addressForm.get('departamento').invalid && addressForm.get('departamento').touched
                "
              >
                Departamento
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="departamento">
                  <mat-option *ngFor="let dpt of listDepartamento" [value]="dpt.value">
                    {{ dpt.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="municipio"
                [class.color-secondaryColor]="
                  addressForm.get('municipio').invalid && addressForm.get('municipio').touched
                "
              >
                Municipio
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="municipio">
                  <mat-option *ngFor="let municipio of listMunicipio" [value]="municipio.value">
                    {{ municipio.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="institucionEducativa"
                [class.color-secondaryColor]="
                  addressForm.get('institucionEducativa').invalid && addressForm.get('institucionEducativa').touched
                "
              >
                Institución Educativa
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="institucionEducativa">
                  <mat-option *ngFor="let instEducativa of listInstEducativa" [value]="instEducativa.value">
                    {{ instEducativa.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="dede"
                [class.color-secondaryColor]="
                  addressForm.get('dede').invalid && addressForm.get('dede').touched
                "
              >
                Sede
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="dede">
                  <mat-option *ngFor="let sede of listSede" [value]="sede.value">
                    {{ sede.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="tipoIntervencion"
                [class.color-secondaryColor]="
                  addressForm.get('tipoIntervencion').invalid && addressForm.get('tipoIntervencion').touched
                ">
                Tipo de Intervención
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="tipoIntervencion">
                  <mat-option *ngFor="let tipoIntervencion of listTipoIntervencion" [value]="tipoIntervencion.codigo">
                    {{ tipoIntervencion.nombre }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="pr-1">
              <label
                class="label-left"
                for="vigenciaContratacion"
                [class.color-secondaryColor]="
                  addressForm.get('vigenciaContratacion').invalid && addressForm.get('vigenciaContratacion').touched
                "
              >
                Vigencia de la contratación
              </label>
            </div>
            <div class="col">
              <mat-form-field class="select-width">
                <mat-select formControlName="vigenciaContratacion">
                  <mat-option *ngFor="let vigencia of listVigencias" [value]="vigencia">
                    {{ vigencia }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions class="text-center">
      <button
        mat-button
        color="primary"
        class="btn-buscar btn-borrar"
        type="button"
        (click)="reiniciarFiltro()"
        [disabled]="
          !addressForm.get('llaveMen').value &&
          !addressForm.get('departamento').value &&
          !addressForm.get('municipio').value &&
          !addressForm.get('institucionEducativa').value &&
          !addressForm.get('dede').value &&
          !addressForm.get('tipoIntervencion').value &&
          !addressForm.get('vigenciaContratacion').value
        "
      >
        <img src="assets/img/icon/borrar.svg" alt="buscar" />
      </button>

      <button
        mat-button
        color="primary"
        class="btn-buscar"
        type="submit"
      >
        <img src="assets/img/icon/lupa.svg" alt="buscar" />
        Buscar
      </button>
    </mat-card-actions>
  </mat-card>
</form>

<div class="animatedDown" *ngIf="verResultados && resultados.length > 0">
  <app-tabla-resultados-proyecto (morstrarFicha)="verFicha( $event )" [resultados]="resultados"></app-tabla-resultados-proyecto>
</div>
<div class="animatedDown" *ngIf="mostrarFicha && indicadores != null">
  <app-menu-ficha-proyecto [indicadores]="indicadores"></app-menu-ficha-proyecto>
</div>
